@model AvgMeasurementModel
<style>
    .center-table {
        width: 100%;
        margin: auto;
        text-align: left;
        border-collapse: collapse;
        border: 1px solid #ddd; /* Light gray border */
    }
        .center-table th {
            background-color: #f2f2f2; /* Light gray background for header */
            font-weight: bold;
            padding: 10px;
            border: 1px solid #ddd; /* Light gray border */
        }
        .center-table td {
            text-align: center;
            padding: 10px;
            border: 1px solid #ddd; /* Light gray border */
        }
        .center-table tr:nth-child(even) {
            background-color: #f9f9f9; /* Alternate row background */
        }




    .feedback-table {
        width: 100%;
        margin: auto;
        text-align: left;
        border-collapse: collapse;
        border: 1px solid #ddd; 
        margin-top:30px;
    }

        .feedback-table th {
            background-color: #f2f2f2; /* Light gray background for header */
            font-weight: bold;
            padding: 10px;
            border: 1px solid #ddd; /* Light gray border */
        }

    .feedback-table td {
       
            padding: 10px;
            border: 1px solid #ddd; /* Light gray border */
        }

        .feedback-table tr:nth-child(even) {
            background-color: #f9f9f9; /* Alternate row background */
        }
    .kpi-name {
        background-color: #e6f2ff; /* Light blue background for KPI names */
    }
    .rate {
        background-color: #eaf1dd; /* Light green background for total rate */
    }
    .avg {
        background-color: #f9eec1; /* Light yellow background for total average */
    }
    .name {
        background-color: #e2e2e2; /* Light gray background for manager names */
    }
    .manager {
        background-color: #ffd1b3; /* Light orange background for managers */
    }
</style>

<div class="data">
    @if (Model == null)
    {
        <p>No data available.</p>
    }
    else if (Model.KPIName == null)
    {
    }
    else if (!Model.KPIName.Any())
    {
        @* <p>KPIName is empty</p> *@
    }
    else
    {
        <table class="center-table">
            <!-- Table headers -->
            <tr>
                <!-- Loop through distinct manager names -->
                <th class="name">KPIName</th>
@*                 @foreach (var managerName in Model.employeeRatePerKPIs.Select(e => e.ManagerName).Distinct())
                {
                    <th class="manager">@managerName</th>
                } *@
                <th class="rate">Total Rate</th>
                <th class="avg">Total Average</th>
            </tr>
            <!-- Table body -->
            @foreach (var kpi in Model.KPIName)
            {
                <tr>
                    <td class="kpi-name">@kpi</td>
@*                     <!-- Loop through rates for each KPI -->
                    @foreach (var rate in Model.employeeRatePerKPIs.Where(e => e.KPIName == kpi))
                    {
                        <td>@rate.Rate</td>
                    } *@
                    <!-- Display total rate and average rate -->
                    <td>@Model.employeeTotalAvgRates.FirstOrDefault(item => item.KPIName == kpi)?.TotalRating</td>
                    <td>@Model.employeeTotalAvgRates.FirstOrDefault(item => item.KPIName == kpi)?.AvgRateing.ToString("F2")</td>
                </tr>
            }
        </table>
        @if (Model.Feedbacks != null ||Model.Feedbacks.Count != 0)
        {
            @if(Model.ShowFeedbackId == 1){
            <table class="feedback-table">

                <tr><th>Employee</th> <th>Feedback</th></tr>
                @foreach (var feedback in Model.Feedbacks)
                {
                    <tr>
                        @Html.Raw(feedback)
            </tr>
            }
        </table>
            }

            @if (Model.ShowFeedbackId == 2)
            {
                <table class="feedback-table">

                    <tr><th>Feedback</th></tr>
                    @foreach (var feedback in Model.Feedbacks)
                    {
                        <tr>
                            @Html.Raw(feedback)
                        </tr>
                    }
                </table>
            }
        }
    }
</div>