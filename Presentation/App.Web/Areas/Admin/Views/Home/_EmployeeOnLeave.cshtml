@model EmployeeOnLeaveSearchModel

@using App.Core
@inject App.Services.Common.IGenericAttributeService genericAttributeService
@inject IWorkContext workContext
@{
    const string cardId = "popular-search-terms-card";
    const string hideCardAttributeName = "Reports.HidePopularSearchTermsReport";
    var hideCard = await genericAttributeService.GetAttributeAsync<bool>(await workContext.GetCurrentCustomerAsync(), hideCardAttributeName);
}

@if (await permissionService.AuthorizeAsync(StandardPermissionProvider.ManageLeaveManagement, PermissionAction.View))
{
    <div class="card card-primary card-outline @if(hideCard){<text>collapsed-card</text>}" id="@cardId">
        <div class="card-header with-border">
            <h3 class="card-title">
                <i class="fas fa-search"></i>
                @T("Admin.EmployeeOnLeave")
            </h3>
            <div class="card-tools float-right">
                <button class="btn btn-tool" data-card-widget="collapse">
                    @if (hideCard)
                    {
                        <text><i class="fas fa-plus"></i></text>
                    }
                    else
                    {
                        <text><i class="fas fa-minus"></i></text>
                    }
                </button>
            </div>
        </div>
        <script>
            $(document).ready(function () {
                $('#@cardId').on('click', 'button[data-card-widget="collapse"]', function () {
                    var collapsed = !$('#@cardId').hasClass('collapsed-card');
                    saveUserPreferences('@(Url.Action("SavePreference", "Preferences"))', '@hideCardAttributeName', collapsed);
                });
            });
        </script>
        <div class="card-body">
            @await Html.PartialAsync("Table", new DataTablesModel
            {
                Name = "search-term-report-grid",
                UrlRead = new DataUrl("EmployeeOnLeave", "Common", null),
                Length = Model.PageSize,
                LengthMenu = Model.AvailablePageSizes,
                Dom = "<'row'<'col-md-12't>>",
                ColumnCollection = new List<ColumnProperty>
                {
                    new ColumnProperty(nameof(EmployeeOnLeaveModel.Date))
                    {
                        Title = T("Admin.EmployeeOnLeave.Date").Text
                    },
                    new ColumnProperty(nameof(EmployeeOnLeaveModel.Emplyoee))
                    {
                        Title = T("Admin.EmployeeOnLeave.Emplyoee").Text
                    }
                }
            })
        </div>
    </div>
}